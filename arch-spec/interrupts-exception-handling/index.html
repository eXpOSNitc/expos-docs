<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="OS Lab website for NIT Calicut"><link href=https://exposnitc.github.io/expos-docs/arch-spec/interrupts-exception-handling/ rel=canonical><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.2.1, mkdocs-material-7.1.10"><title>Interrupts and Exception handling - eXpOS NITC</title><link rel=stylesheet href=../../assets/stylesheets/main.1fe995fd.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.f1a3b89f.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/css/extra.css></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent> <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#timer-interrupt class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-announce> <div class="md-announce__inner md-grid md-typeset"> <b>Site is undergoing migration.</b> Old URL: <a href=http://eXpOSNitc.github.io/arch_spec-files/interrupts_exception_handling.html target=_blank rel="nofollow noopener">http://eXpOSNitc.github.io/arch_spec-files/interrupts_exception_handling.html</a> </div> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="eXpOS NITC" class="md-header__button md-logo" aria-label="eXpOS NITC" data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> eXpOS NITC </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Interrupts and Exception handling </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=teal data-md-color-accent aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/eXpOSNitc/expos-docs/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> eXpOSNitc/expos-docs </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../documentation/ class="md-tabs__link md-tabs__link--active"> Documentation </a> </li> <li class=md-tabs__item> <a href=../../roadmap/ class=md-tabs__link> Roadmap </a> </li> <li class=md-tabs__item> <a href=../../faq/ class=md-tabs__link> FAQ </a> </li> <li class=md-tabs__item> <a href=../../feedback/ class=md-tabs__link> Student Feedback </a> </li> <li class=md-tabs__item> <a href=https://exposnitc.github.io/user-contrib/ target=_blank class=md-tabs__link> User Contributions </a> </li> <li class=md-tabs__item> <a href=../../about/ class=md-tabs__link> About </a> </li> <li class=md-tabs__item> <a href=http://xosnitc.github.io target=_blank class=md-tabs__link> XOS </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation hidden> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="eXpOS NITC" class="md-nav__button md-logo" aria-label="eXpOS NITC" data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> eXpOS NITC </label> <div class=md-nav__source> <a href=https://github.com/eXpOSNitc/expos-docs/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> eXpOSNitc/expos-docs </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2> Documentation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Documentation data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Documentation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../documentation/ class=md-nav__link> Documentation </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> Operating System <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Operating System" data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Operating System </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2_1 type=checkbox id=__nav_2_2_1> <label class=md-nav__link for=__nav_2_2_1> Specification <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Specification data-md-level=3> <label class=md-nav__title for=__nav_2_2_1> <span class="md-nav__icon md-icon"></span> Specification </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../os-spec/ class=md-nav__link> Specification </a> </li> <li class=md-nav__item> <a href=../../os-spec/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../os-spec/expos-abstractions/ class=md-nav__link> eXpOS Abstractions </a> </li> <li class=md-nav__item> <a href=../../os-spec/expfs/ class=md-nav__link> The Logical File System eXpFS </a> </li> <li class=md-nav__item> <a href=../../os-spec/processmodel/ class=md-nav__link> Process Model </a> </li> <li class=md-nav__item> <a href=../../os-spec/synchronization/ class=md-nav__link> Synchronization and Access Control </a> </li> <li class=md-nav__item> <a href=../../os-spec/misc/ class=md-nav__link> Micellaneous </a> </li> <li class=md-nav__item> <a href=../../os-spec/multiuser/ class=md-nav__link> Multi-User Extension to eXpOS </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2_1_9 type=checkbox id=__nav_2_2_1_9> <label class=md-nav__link for=__nav_2_2_1_9> Application Programmer's Interface (API) <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Application Programmer's Interface (API)" data-md-level=4> <label class=md-nav__title for=__nav_2_2_1_9> <span class="md-nav__icon md-icon"></span> Application Programmer's Interface (API) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../os-spec/systemcallinterface/ class=md-nav__link> High Level System Call Interface </a> </li> <li class=md-nav__item> <a href=../../os-spec/dynamicmemoryroutines/ class=md-nav__link> High Level Library Interface </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../os-spec/shell-spec/ class=md-nav__link> eXpOS Shell Specification </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2_2 type=checkbox id=__nav_2_2_2> <label class=md-nav__link for=__nav_2_2_2> Design <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Design data-md-level=3> <label class=md-nav__title for=__nav_2_2_2> <span class="md-nav__icon md-icon"></span> Design </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../os-design/ class=md-nav__link> Design </a> </li> <li class=md-nav__item> <a href=../../os-design/misc/ class=md-nav__link> Micellaneous </a> </li> <li class=md-nav__item> <a href=../../os-design/exe-handler/ class=md-nav__link> Exception Handler </a> </li> <li class=md-nav__item> <a href=../../os-design/timer/ class=md-nav__link> Timer </a> </li> <li class=md-nav__item> <a href=../../os-design/disk-interrupt/ class=md-nav__link> Disk Interrupt Handler </a> </li> <li class=md-nav__item> <a href=../../os-design/term-handler/ class=md-nav__link> Terminal Interrupt Handler </a> </li> <li class=md-nav__item> <a href=../../os-design/shutdown/ class=md-nav__link> Shutdown </a> </li> <li class=md-nav__item> <a href=../../os-design/create/ class=md-nav__link> Create </a> </li> <li class=md-nav__item> <a href=../../os-design/delete/ class=md-nav__link> Delete </a> </li> <li class=md-nav__item> <a href=../../os-design/open/ class=md-nav__link> Open </a> </li> <li class=md-nav__item> <a href=../../os-design/close/ class=md-nav__link> Close </a> </li> <li class=md-nav__item> <a href=../../os-design/read/ class=md-nav__link> Read </a> </li> <li class=md-nav__item> <a href=../../os-design/write/ class=md-nav__link> Write </a> </li> <li class=md-nav__item> <a href=../../os-design/seek/ class=md-nav__link> Seek </a> </li> <li class=md-nav__item> <a href=../../os-design/fork/ class=md-nav__link> Fork </a> </li> <li class=md-nav__item> <a href=../../os-design/exec/ class=md-nav__link> Exec </a> </li> <li class=md-nav__item> <a href=../../os-design/exit/ class=md-nav__link> Exit </a> </li> <li class=md-nav__item> <a href=../../os-design/proc-misc/ class=md-nav__link> Process Micellaneous </a> </li> <li class=md-nav__item> <a href=../../os-design/synchronization-algos/ class=md-nav__link> Synchronization Algorithms </a> </li> <li class=md-nav__item> <a href=../../os-design/semaphore-algos/ class=md-nav__link> Semaphore Algorithms </a> </li> <li class=md-nav__item> <a href=../../os-design/multiusersyscalls/ class=md-nav__link> Multi-User System Calls </a> </li> <li class=md-nav__item> <a href=../../os-design/disk-ds/ class=md-nav__link> Disk Data Structures </a> </li> <li class=md-nav__item> <a href=../../os-design/process-table/ class=md-nav__link> Process Table </a> </li> <li class=md-nav__item> <a href=../../os-design/mem-ds/ class=md-nav__link> Memory Data Structures </a> </li> <li class=md-nav__item> <a href=../../os-design/state-diag/ class=md-nav__link> Process State Diagram </a> </li> <li class=md-nav__item> <a href=../../os-design/nexpos/ class=md-nav__link> NeXpOS Design </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2_3 type=checkbox id=__nav_2_2_3> <label class=md-nav__link for=__nav_2_2_3> Implementation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Implementation data-md-level=3> <label class=md-nav__title for=__nav_2_2_3> <span class="md-nav__icon md-icon"></span> Implementation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../os-implementation/ class=md-nav__link> Implementation </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2_3_2 type=checkbox id=__nav_2_2_3_2> <label class=md-nav__link for=__nav_2_2_3_2> Kernel Stack Management <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Kernel Stack Management" data-md-level=4> <label class=md-nav__title for=__nav_2_2_3_2> <span class="md-nav__icon md-icon"></span> Kernel Stack Management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../os-design/stack-smcall/ class=md-nav__link> During System Calls </a> </li> <li class=md-nav__item> <a href=../../os-design/stack-interrupt/ class=md-nav__link> During Hardware interrupts or exceptions </a> </li> <li class=md-nav__item> <a href=../../os-design/stack-module/ class=md-nav__link> During Module calls </a> </li> <li class=md-nav__item> <a href=../../os-design/timer-stack-management/ class=md-nav__link> During Context Switch </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3 checked> <label class=md-nav__link for=__nav_2_3> Architecture <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Architecture data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_1 type=checkbox id=__nav_2_3_1 checked> <label class=md-nav__link for=__nav_2_3_1> Specification <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Specification data-md-level=3> <label class=md-nav__title for=__nav_2_3_1> <span class="md-nav__icon md-icon"></span> Specification </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> XSM Architecture Specifcation </a> </li> <li class=md-nav__item> <a href=../../virtual-machine-spec/ class=md-nav__link> Virtual Machine Model </a> </li> <li class=md-nav__item> <a href=../machine-organization/ class=md-nav__link> Machine Organisation </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Interrupts and Exception Handling <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Interrupts and Exception Handling </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#timer-interrupt class=md-nav__link> Timer Interrupt </a> </li> <li class=md-nav__item> <a href=#disk-controller-interrupt class=md-nav__link> Disk Controller Interrupt </a> </li> <li class=md-nav__item> <a href=#console-interrupt class=md-nav__link> Console Interrupt </a> </li> <li class=md-nav__item> <a href=#race-conditions class=md-nav__link> Race Conditions </a> </li> <li class=md-nav__item> <a href=#exceptions class=md-nav__link> Exceptions </a> <nav class=md-nav aria-label=Exceptions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#illegal-instruction class=md-nav__link> Illegal instruction </a> </li> <li class=md-nav__item> <a href=#illegal-memory-access class=md-nav__link> Illegal Memory Access </a> </li> <li class=md-nav__item> <a href=#arithmetic-exception class=md-nav__link> Arithmetic exception </a> </li> <li class=md-nav__item> <a href=#page-fault class=md-nav__link> Page Fault </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#software-interrupts class=md-nav__link> Software Interrupts </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../instruction-set/ class=md-nav__link> Instruction Set </a> </li> <li class=md-nav__item> <a href=../paging-hardware/ class=md-nav__link> Paging Hardware and Address Translation </a> </li> <li class=md-nav__item> <a href=../nexsm/ class=md-nav__link> NEXSM (Two Core) Architecture Specification </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_2 type=checkbox id=__nav_2_3_2> <label class=md-nav__link for=__nav_2_3_2> Modules <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Modules data-md-level=3> <label class=md-nav__title for=__nav_2_3_2> <span class="md-nav__icon md-icon"></span> Modules </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modules/ class=md-nav__link> Modules </a> </li> <li class=md-nav__item> <a href=../../modules/module-00/ class=md-nav__link> Module 0 </a> </li> <li class=md-nav__item> <a href=../../modules/module-01/ class=md-nav__link> Module 1 </a> </li> <li class=md-nav__item> <a href=../../modules/module-02/ class=md-nav__link> Module 2 </a> </li> <li class=md-nav__item> <a href=../../modules/module-03/ class=md-nav__link> Module 3 </a> </li> <li class=md-nav__item> <a href=../../modules/module-04/ class=md-nav__link> Module 4 </a> </li> <li class=md-nav__item> <a href=../../modules/module-05/ class=md-nav__link> Module 5 </a> </li> <li class=md-nav__item> <a href=../../modules/module-06/ class=md-nav__link> Module 6 </a> </li> <li class=md-nav__item> <a href=../../modules/module-07/ class=md-nav__link> Module 7 </a> </li> <li class=md-nav__item> <a href=../../modules/module-08/ class=md-nav__link> Module 8 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3 type=checkbox id=__nav_2_3_3> <label class=md-nav__link for=__nav_2_3_3> Tutorials <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tutorials data-md-level=3> <label class=md-nav__title for=__nav_2_3_3> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tutorials/multiuser-implementation/ class=md-nav__link> MultiUser Implementation </a> </li> <li class=md-nav__item> <a href=../../tutorials/filesystem-implementation/ class=md-nav__link> FileSystem Implementation </a> </li> <li class=md-nav__item> <a href=../../tutorials/process-management-implementation/ class=md-nav__link> Process Management Implementation </a> </li> <li class=md-nav__item> <a href=../../tutorials/xsm-instruction-cycle/ class=md-nav__link> XSM Instruction Cycle </a> </li> <li class=md-nav__item> <a href=../../tutorials/xsm-interrupts-tutorial/ class=md-nav__link> XSM Interrupts tutorial </a> </li> <li class=md-nav__item> <a href=../../tutorials/xsm-unprivileged-tutorial/ class=md-nav__link> XSM Unprivileged tutorial </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_4 type=checkbox id=__nav_2_3_4> <label class=md-nav__link for=__nav_2_3_4> Support Tools <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Support Tools" data-md-level=3> <label class=md-nav__title for=__nav_2_3_4> <span class="md-nav__icon md-icon"></span> Support Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../support-tools/setting-up/ class=md-nav__link> Setting up </a> </li> <li class=md-nav__item> <a href=../../support-tools/docker-setup/ class=md-nav__link> Docker based setup </a> </li> <li class=md-nav__item> <a href=../../support-tools/xfs-interface/ class=md-nav__link> XFS Interface </a> </li> <li class=md-nav__item> <a href=../../support-tools/spl/ class=md-nav__link> SPL </a> </li> <li class=md-nav__item> <a href=../../support-tools/expl/ class=md-nav__link> ExpL </a> </li> <li class=md-nav__item> <a href=../../support-tools/xsm-simulator/ class=md-nav__link> XSM Simulator </a> </li> <li class=md-nav__item> <a href=../../support-tools/constants/ class=md-nav__link> Constants </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_5 type=checkbox id=__nav_2_3_5> <label class=md-nav__link for=__nav_2_3_5> Application Interface <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Application Interface" data-md-level=3> <label class=md-nav__title for=__nav_2_3_5> <span class="md-nav__icon md-icon"></span> Application Interface </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../abi/ class=md-nav__link> Application Binary Interface (ABI) </a> </li> <li class=md-nav__item> <a href=../../os-design/sw-interface/ class=md-nav__link> Low Level System Call Interface </a> </li> <li class=md-nav__item> <a href=../../os-spec/dynamicmemoryroutines/ class=md-nav__link> High Level Library Interface </a> </li> <li class=md-nav__item> <a href=../../abi/ class=md-nav__link> Low Level Library Interface </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> Others <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Others data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Others </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_1 type=checkbox id=__nav_2_4_1> <label class=md-nav__link for=__nav_2_4_1> Test Programs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Test Programs" data-md-level=3> <label class=md-nav__title for=__nav_2_4_1> <span class="md-nav__icon md-icon"></span> Test Programs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../test-programs/ class=md-nav__link> Test Programs </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-01/ class=md-nav__link> Program 1 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-02/ class=md-nav__link> Program 2 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-03/ class=md-nav__link> Program 3 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-04/ class=md-nav__link> Program 4 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-05/ class=md-nav__link> Program 5 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-06/ class=md-nav__link> Program 6 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-07/ class=md-nav__link> Program 7 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-08/ class=md-nav__link> Program 8 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-09/ class=md-nav__link> Program 9 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-10/ class=md-nav__link> Program 10 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-11/ class=md-nav__link> Program 11 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-12/ class=md-nav__link> Program 12 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-13/ class=md-nav__link> Program 13 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-14/ class=md-nav__link> Program 14 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-15/ class=md-nav__link> Program 15 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-16/ class=md-nav__link> Program 16 </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Roadmap <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Roadmap data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Roadmap </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../roadmap/ class=md-nav__link> Roadmap </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> Preparatory Stages <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Preparatory Stages" data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Preparatory Stages </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../roadmap/stage-01/ class=md-nav__link> Stage 1 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-02/ class=md-nav__link> Stage 2 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-03/ class=md-nav__link> Stage 3 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-04/ class=md-nav__link> Stage 4 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-05/ class=md-nav__link> Stage 5 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-06/ class=md-nav__link> Stage 6 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-07/ class=md-nav__link> Stage 7 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-08/ class=md-nav__link> Stage 8 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-09/ class=md-nav__link> Stage 9 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-10/ class=md-nav__link> Stage 10 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-11/ class=md-nav__link> Stage 11 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-12/ class=md-nav__link> Stage 12 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3> Intermediate Stages <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Intermediate Stages" data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Intermediate Stages </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../roadmap/stage-13/ class=md-nav__link> Stage 13 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-14/ class=md-nav__link> Stage 14 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-15/ class=md-nav__link> Stage 15 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-16/ class=md-nav__link> Stage 16 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-17/ class=md-nav__link> Stage 17 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-18/ class=md-nav__link> Stage 18 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-19/ class=md-nav__link> Stage 19 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4> Final Stages <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Final Stages" data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Final Stages </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../roadmap/stage-20/ class=md-nav__link> Stage 20 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-21/ class=md-nav__link> Stage 21 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-22/ class=md-nav__link> Stage 22 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-23/ class=md-nav__link> Stage 23 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-24/ class=md-nav__link> Stage 24 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-25/ class=md-nav__link> Stage 25 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-26/ class=md-nav__link> Stage 26 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-27/ class=md-nav__link> Stage 27 </a> </li> <li class=md-nav__item> <a href=../../roadmap/stage-28/ class=md-nav__link> Stage 28 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../faq/ class=md-nav__link> FAQ </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> Student Feedback <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Student Feedback" data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Student Feedback </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../feedback/ class=md-nav__link> Student Feedback </a> </li> <li class=md-nav__item> <a href=../../feedback/nitc21/ class=md-nav__link> NIT-C 2021 </a> </li> <li class=md-nav__item> <a href=../../feedback/nitc20/ class=md-nav__link> NIT-C 2020 </a> </li> <li class=md-nav__item> <a href=../../feedback/nitc19/ class=md-nav__link> NIT-C 2019 </a> </li> <li class=md-nav__item> <a href=../../feedback/iitpkd18/ class=md-nav__link> IIT PKD 2018 </a> </li> <li class=md-nav__item> <a href=../../feedback/nitc18/ class=md-nav__link> NIT-C 2018 </a> </li> <li class=md-nav__item> <a href=../../feedback/analysis/ class=md-nav__link> Analysis of Student Feedback </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://exposnitc.github.io/user-contrib/ target=_blank class=md-nav__link> User Contributions </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7> About <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=About data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../about/ class=md-nav__link> About </a> </li> <li class=md-nav__item> <a href=../../changelog/ class=md-nav__link> Changelog </a> </li> <li class=md-nav__item> <a href=../../reports/ class=md-nav__link> Project Reports </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=http://xosnitc.github.io target=_blank class=md-nav__link> XOS </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#timer-interrupt class=md-nav__link> Timer Interrupt </a> </li> <li class=md-nav__item> <a href=#disk-controller-interrupt class=md-nav__link> Disk Controller Interrupt </a> </li> <li class=md-nav__item> <a href=#console-interrupt class=md-nav__link> Console Interrupt </a> </li> <li class=md-nav__item> <a href=#race-conditions class=md-nav__link> Race Conditions </a> </li> <li class=md-nav__item> <a href=#exceptions class=md-nav__link> Exceptions </a> <nav class=md-nav aria-label=Exceptions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#illegal-instruction class=md-nav__link> Illegal instruction </a> </li> <li class=md-nav__item> <a href=#illegal-memory-access class=md-nav__link> Illegal Memory Access </a> </li> <li class=md-nav__item> <a href=#arithmetic-exception class=md-nav__link> Arithmetic exception </a> </li> <li class=md-nav__item> <a href=#page-fault class=md-nav__link> Page Fault </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#software-interrupts class=md-nav__link> Software Interrupts </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <!-- Edit button --> <a href=https://github.com/eXpOSNitc/expos-docs/edit/main/docs/arch-spec/interrupts-exception-handling.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <!--
    Hack: check whether the content contains a h1 headline. If it
    doesn't, the page title (or respectively site name) is used
    as the main headline.
    --> <h1>Interrupts and Exception handling</h1> <!-- Markdown content --> <div class="admonition warning"> <p class=admonition-title>Important Note</p> <p><em>Througout the architecture documentation, we have used the terms kernel mode for previleged mode and user mode for unprevileged mode of machine execution. However, "kernel" and "user" are OS level abstractions and not connected with the hardware. Hence the above usage is incorrect technically. However since the kernel of an OS normally runs in the previliged mode and user programs execute in the unpreviliged mode, the (incorrect) terminology has been used.</em></p> </div> <p>XSM supports a total of 19 interrupts. Each interrupt is identified by its number between 0 and 18. Among these, Interrupt 0 is the exception handler, Interrupt 1 is the timer interrupt, Interrupt 2 is the disk controller interrupt and Interrupt 3 is the console interrupt. Interrupts 1, 2 and 3 are hardware interrupts. The interrupts 4 to 18 are software interrupts. Software interrupts occur when they are invoked by a program in execution. A program can invoke a software interrupt using the INT machine instruction. However, <em>hardware interrupts</em> and the <em>exception handler</em> cannot be invoked from user mode programs.</p> <p>Associated with each interrupt/exception, there is an interrupt handler. When an interrupt occurs, the corresponding handler is executed. XSM specification reserves two contiguous memory pages for loading each interrupt handler according to the table given in <a href=../machine-organization/ >Memory Organisation</a>. When an interrupt/exception occurs, the machine transfers control to the beginning of the first page of the corresponding handler. It is the responsibility of the OS/Kernel programmer to store the interrupt handler routines in the disk and load them to the corresponding pages at the time of system startup.</p> <p>Note: Internally XSM machine has an <em>interrupt vector table</em> that maps each interrupt number to a corresponding address (of the interrupt handler). The vector table is stored starting from physical address 492 of the ROM memory. Locations 492,493,494 and 495 stores the addresses of exception handler, timer interrupt handler, disk interrupt handler and console interrupt handler. Location 496 contains the address of the first software interrupt handler - INT 4, location 497 contains address of INT 5 handler and so on. When the machine encounters an INT n instruction, the corresponding ROM location is searched for the handler address and IP is set to this value. Since the values are hard-coded in the ROM code of the XSM simulator given to you, you cannot change the addresses of these handlers. See <a href=../machine-organization/#boot-rom-and-boot-block>here</a> for more details about Boot ROM and interrupt vector table.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>XSM does not allow the INT instruction to be executed in kernel mode.</p> </div> <h3 id=timer-interrupt><strong>Timer Interrupt</strong><a class=headerlink href=#timer-interrupt title="Permanent link">&para;</a></h3> <p>The XSM architecture includes a timer that can cause periodic interrupts during execution in unprivileged mode. The timer ticks with each unprivileged instruction executed and once the number of ticks reaches a threshold specified during boot-time (see --timer option of the <a href=../../support-tools/xsm-simulator/ >XSM simulator</a>), the tick counter is reset and a timer interrupt is raised. At that point, the machine executes the following actions:</p> <ol> <li><img alt=🔴 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f534.svg title=:red_circle:> Increment the value of the SP register and push the value in the IP register into the memory address pointed to by SP. Since the machine is executing in unpreviliged mode, the address in SP is treated as a logical address and the machine performs <a href=../paging-hardware/ >address translation</a> to calculate the physical address corresponding to the SP value.</li> <li>Set IP to value stored in the interrupt vector table entry for the timer interrupt handler. The vector table entry for timer interrupt is located at physical address 493 in page 0 (ROM) of XSM and the value 2048 is preset in this location. Hence, the IP register gets value 2048 and the machine switches to privileged mode. Consequently, the next instruction will be fetched from physical address 2048, and the machine will continue execution in previliged mode (without peforming address translation).</li> </ol> <div class="admonition note"> <p class=admonition-title>Note</p> <p><img alt=🔴 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f534.svg title=:red_circle:> If the value in the SP register after incrementing SP is an invalid address (i.e., not in the range 0 to PTLR*512-1) then the machine generates an <strong>illegal memory access exception</strong> (see section below on exception handling). The machine will re-execute steps (1) and (2) immedietly after retrun to unprivileged mode, before executing any other instruction in unprivileged mode.</p> </div> <p>Thus the occurance of the timer interrupt results in machine execution to be transferred to the timer interrupt handler (INT 1) stored in page 4-5.</p> <h3 id=disk-controller-interrupt><strong>Disk Controller Interrupt</strong><a class=headerlink href=#disk-controller-interrupt title="Permanent link">&para;</a></h3> <p>The Disk Controller allows for imitating asynchronous disk access by the OS. Whenever the machine executes the LOAD/STORE instruction, the Disk Controller initiates a counter that ticks with each unprivileged instruction executed after the LOAD/STORE instruction. Once the counter reaches a threshold value specified during boot-time (see --disk option of the <a href=../../support-tools/xsm-simulator/ >XSM simulator</a>), the counter is reset and a disk interrupt (INT 2) is raised. At that point, the machine executes the following actions:</p> <ol> <li><img alt=🔵 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f535.svg title=:blue_circle:> Increment the value of the SP register and push the value in the IP register into the memory address pointed to by SP. Since the machine is executing in unpreviliged mode, the address in SP is treated as a logical address and the machine performs <a href=../paging-hardware/ >address translation</a> to calculate the physical address corresponding to the SP value.</li> <li>Set IP to value stored in the interrupt vector table entry for the disk interrupt handler. The vector table entry for disk interrupt is located at physical address 494 in page 0 (ROM) of XSM and the value 3072 is preset in this location. Hence, the IP register gets value 3072 and the machine switches to privileged mode. Consequently, the next instruction will be fetched from physical address 3072, and the machine will continue execution in previliged mode (without peforming address translation).</li> </ol> <div class="admonition note"> <p class=admonition-title>Note</p> <p><img alt=🔵 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f535.svg title=:blue_circle:> If the value in the SP register after incrementing SP is an invalid address (i.e., not in the range 0 to PTLR*512-1) then the machine generates an <strong>illegal memory access exception</strong> (see section below on exception handling). The machine will re-execute steps (1) and (2) immedietly after retrun to unprivileged mode, before executing any other instruction in unprivileged mode.</p> </div> <p>Thus the occurance of the disk interrupt results in machine execution to be transferred to the disk interrupt handler (INT 2) stored in page 6-7. As noted above, the macros LOAD/STORE are used to send requests to the Disk Controller.</p> <p>The Disk Controller does not support parallel input requests. Thus it is the OS Programmer's duty to ensure that multiple disk requests are not raised. That is, the OS must take care of ensuring that after a LOAD/STORE instruction is executed, another LOAD/STORE instruction is executed only after the device controller has raised the device interrupt, marking the completion of the first request.</p> <h3 id=console-interrupt><strong>Console Interrupt</strong><a class=headerlink href=#console-interrupt title="Permanent link">&para;</a></h3> <p>The XSM Architecture has a Console Device which acts as the IO interface for user interaction. When a program requires interacting with the user, the macros 'IN', 'INI' and 'OUT' are used to invoke the Console Device. Output (OUT instruction) is a synchronous process and works immediately. Whenever the machine executes the console input instruction (IN instruction), the Console Device initiates a counter that ticks with each unprivileged instruction executed after the IN instruction. Once the counter reaches a threshold value specified during boot-time (see --console option of the <a href=../../support-tools/xsm-simulator/ >XSM simulator</a>), the counter and the machine simulator waits for the user to enter some data into the console. When the user eventually enters the input, the counter is reset and the console interrupt (INT 3) is raised. At that point, the machine executes the following actions:</p> <ol> <li><img alt=🟢 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f7e2.svg title=:green_circle:> Increment the value of the SP register and push the value in the IP register into the memory address pointed to by SP. Since the machine is executing in unpreviliged mode, the address in SP is treated as a logical address and the machine performs <a href=../paging-hardware/ >address translation</a> to calculate the physical address corresponding to the SP value.</li> <li>Set IP to value stored in the interrupt vector table entry for the console interrupt handler. The vector table entry for console interrupt is located at physical address 495 in page 0 (ROM) of XSM and the value 4096 is preset in this location. Hence, the IP register gets value 4096 and the machine switches to privileged mode. Consequently, the next instruction will be fetched from physical address 4096, and the machine will continue execution in previleged mode (without peforming address translation).</li> </ol> <div class="admonition note"> <p class=admonition-title>Note</p> <p><img alt=🟢 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f7e2.svg title=:green_circle:> If the value in the SP register after incrementing SP is an invalid address (i.e., not in the range 0 to PTLR*512-1) then the machine generates an <strong>illegal memory access exception</strong> (see section below on exception handling). The machine will re-execute steps (1) and (2) immedietly after retrun to unprivileged mode, before executing any other instruction in unprivileged mode.</p> </div> <p>Thus the occurance of the console interrupt results in machine execution to be transferred to the console interrupt handler (INT 3) stored in page 8-9. As noted above, the macro instruction IN is used to send input requests to the Console device.</p> <p>The Console Device does not support parallel input requests. Thus it is the OS Programmer's duty to ensure that multiple IN requests are not raised. Control is transferred to the user program by the interrupt routine only after the user inputs a word from the Console.</p> <p>The INI instruction (which can be used only in debug mode) is a special instruction which allows synchronous console input where the machine doesn't raise an interrupt but waits for the user to enter the data before proceeding to the next instruction.</p> <h3 id=race-conditions><strong>Race Conditions</strong><a class=headerlink href=#race-conditions title="Permanent link">&para;</a></h3> <p>After the execution of an instruction in unpriviliged mode, suppose the machine finds that multiple interrupts are pending - say the disk, console and timer interrupts are simultaniously due, then the machine executes the interrupts in the following order - first timer, second disk and third console. After executing the first handler, the machine returns to unpreviliged mode and immedietely executes steps (1) and (2) in the next interrupt and so on till all pending interrupts are processed.</p> <p>As noted above, if an exception occurs at the point of handling any of the above interrupts, the exception is handled first.</p> <h3 id=exceptions><strong>Exceptions</strong><a class=headerlink href=#exceptions title="Permanent link">&para;</a></h3> <p>Exceptions are anomalous situations which changes the normal flow of execution. The machine raises an exception when it runs in <strong>user mode</strong> and encounters an anomalous situation during program execution like division by zero or generation of an invalid address. All exceptions raise Interrupt 0.</p> <p>The XSM Register set consists of four special registers for storing the details regarding exceptions. The exception registers are as shown below</p> <p>1) <strong>Exception IP (EIP)</strong> : Stores the value of IP at the point where the exception occurred.</p> <p>2) <strong>Exception Page Number (EPN)</strong> : This field is relevant when a <strong>Page Fault Exception</strong> occurs. The logical page number which caused a page fault exception is stored here.</p> <p>3) <strong>Exception Cause (EC)</strong> : This field indicates a number which corresponds to the cause of the exception. Exceptions can be caused when the following events occur.</p> <ol> <li>Page Fault : The value stored in the EC register for this exception is 0.</li> <li>Illegal instruction : The value stored in the EC register for this exception is 1.</li> <li>Illegal memory access : The value stored in the EC register for this exception is 2.</li> <li>Arithmetic exception : The value stored in the EC register for this exception is 3.</li> </ol> <p>4) <strong>Exception Memory Address (EMA)</strong> : Exception Memory Address register is relevant only in the case of <strong>illegal memory access</strong>. The illegal memory which was tried to be accessed is stored in the register. This field is relevant only when either the address referred to is outside the range 0 - 512*(PTLR-1) or a write is attempted to a page which is read-only.</p> <p>A detailed discussion on various conditions leading to the machine raising an exception are below:-</p> <h5 id=illegal-instruction><strong>Illegal instruction</strong><a class=headerlink href=#illegal-instruction title="Permanent link">&para;</a></h5> <p>occurs when one of the following conditions occur:-</p> <ol> <li>Destination of a MOV operation is a constant.</li> <li>A register/port not allowed in user mode is accessed.</li> <li>A privileged mode instruction is executed.</li> <li>There is an instruction that does not belong to XSM instruction set or an instruction is given with more/less operands than allowed - syntax error.</li> <li>INT n instruction - n is not in the valid range (4-18).</li> </ol> <p>When one of the above events occur, the machine does the following:- </p> <ol> <li>EIP is set to the value of the IP register, from which instruction that caused the exception was fetched.</li> <li>EPN contents are not valid for this exception.</li> <li>EC is set to value 1 corresponding to illegal instruction.</li> <li>EMA contents are not valid for this exception.</li> <li>Set IP to value stored in the interrupt vector table entry for the exception handler. The vector table entry for exception handler is located at physical address 492 in page 0 (ROM) of XSM and the value 1024 is preset in this location. Hence, the IP register gets value 1024 and the machine switches to privileged mode. Consequently, the next instruction will be fetched from physical address 1024, and the machine will continue execution in previleged mode (without peforming address translation).</li> </ol> <h5 id=illegal-memory-access><strong>Illegal Memory Access</strong><a class=headerlink href=#illegal-memory-access title="Permanent link">&para;</a></h5> <p>occurs when one of the following conditions occur:-</p> <ol> <li>A MOV instruction has an address not in the range 0 to PTLR*512-1. (Even indirect addressing as in MOV R0, [R1] can cause such addresses)</li> <li>RET/POP executed with SP not between 0 and PTLR*512-1.</li> <li>CALL/INT/PUSH/hardware interrupt executed with SP not between -1 and PTLR*512-2.</li> <li>JZ/JNZ/JMP Instruction is executed with IP value not in the range 0 to PTLR*512-1.</li> <li>Write is attempted to a page whose <a href=../paging-hardware/ >write permission bit</a> in the page table entry has been set to 0.</li> </ol> <p>When one of the above events occur, the machine does the following:- </p> <ol> <li>EIP is set to the value of the IP register, from which instruction that caused the exception was fetched.</li> <li>EPN contents are not valid for this exception.</li> <li>EC is set to value 2 corresponding to illegal memory access.</li> <li>EMA is set to logical address that caused the illegal memory access.</li> <li>Set IP to value stored in the interrupt vector table entry for the exception handler. The vector table entry for exception handler is located at physical address 492 in page 0 (ROM) of XSM and the value 1024 is preset in this location. Hence, the IP register gets value 1024 and the machine switches to privileged mode. Consequently, the next instruction will be fetched from physical address 1024, and the machine will continue execution in previleged mode (without performing address translation).</li> </ol> <h5 id=arithmetic-exception><strong>Arithmetic exception</strong><a class=headerlink href=#arithmetic-exception title="Permanent link">&para;</a></h5> <p>Occurs during DIV/MOD instruction with the second operator having value zero. </p> <p>When an arithmetic exception occurs, the machine does the following:- </p> <ol> <li>EIP is set to the value of the IP register, from which instruction that caused the exception was fetched.</li> <li>EPN contents are not valid for this exception.</li> <li>EC is set to value 3 corresponding to arithmetic exception.</li> <li>EMA contents are not valid for this exception.</li> <li>Set IP to value stored in the interrupt vector table entry for the exception handler. The vector table entry for exception handler is located at physical address 492 in page 0 (ROM) of XSM and the value 1024 is preset in this location. Hence, the IP register gets value 1024 and the machine switches to privileged mode. Consequently, the next instruction will be fetched from physical address 1024, and the machine will continue execution in previleged mode (without performing address translation).</li> </ol> <h5 id=page-fault><strong>Page Fault</strong><a class=headerlink href=#page-fault title="Permanent link">&para;</a></h5> <p>Occurs when <strong>none</strong> of the conditions above hold, and the <a href=../paging-hardware/ >valid bit</a> of the page referenced is set to 0. </p> <p>When one of the above events occur, the machine does the following:- </p> <ol> <li>EIP is set to the value of the IP register, from which instruction that caused the exception was fetched.</li> <li>EPN contains the logical page number of the page accessed, that caused the exception.</li> <li>EC is set to value 0 corresponding to page fault.</li> <li>EMA contents are not valid for this exception.</li> <li>Set IP to value stored in the interrupt vector table entry for the exception handler. The vector table entry for exception handler is located at physical address 492 in page 0 (ROM) of XSM and the value 1024 is preset in this location. Hence, the IP register gets value 1024 and the machine switches to privileged mode. Consequently, the next instruction will be fetched from physical address 1024, and the machine will continue execution in previleged mode (without performing address translation).</li> </ol> <h3 id=software-interrupts><strong>Software Interrupts</strong><a class=headerlink href=#software-interrupts title="Permanent link">&para;</a></h3> <p>Software Interrupts are the primary mechanisms by which a user mode program transfers control to the corresponding interrupt handler that runs in the kernel mode. Software interrupt service routines typically contain the OS code for various system calls. Upon return from a software interrupt using the IRET instruction, execution resumes from the next instruction in the user mode program. A total of 15 software interrupts are available (Interrupt 4 - Interrupt 18). Note that <strong>user mode programs cannot invoke the hardware interrupt routines</strong>.</p> <p>When an <em>INT n</em> (n in the range 4-18) instruction occurs, the machine executes the following actions:</p> <ol> <li><img alt=🟣 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f7e3.svg title=:purple_circle:> Increment the value of the SP register and push the value in the IP + 2 (logical address of the next instruction to be executed upon return from the interrupt handler) into the memory address pointed to by SP. Since the machine is executing in unpreviliged mode, the address in SP is treated as a logical address and the machine performs <a href=../paging-hardware/ >address translation</a> to calculate the physical address corresponding to the SP value.</li> <li>Set IP to value stored in the vector table entry for the corresponding interrupt. The vector table entry for <em>INT n</em> is located at physical address <em>492 + n</em> in page 0 (ROM) of XSM and the values are preset as specified in the <a href=../machine-organization/ >Boot ROM and Boot Block section</a> of XSM Machine Organisation documentation. Hence, the IP register gets the value preset in the interrupt vector table and the machine switches to privileged mode. Consequently, the next instruction will be fetched from the preset value, and the machine will continue execution in previleged mode (without peforming address translation).</li> </ol> <div class="admonition note"> <p class=admonition-title>Note</p> <p><img alt=🟣 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f7e3.svg title=:purple_circle:> If the value in the SP register after incrementing SP is an invalid address (i.e., not in the range 0 to PTLR*512-1) then the machine generates an <strong>illegal memory access exception</strong> (see section above on exception handling).</p> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p><strong>INT instruction cannot be executed when the machine is executing in privileged mode.</strong> (see <a href=../instruction-set/ >instruction set</a>)</p> </div> <!-- Last update of source file --> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../machine-organization/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Machine Organisation" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Machine Organisation </div> </div> </a> <a href=../instruction-set/ class="md-footer__link md-footer__link--next" aria-label="Next: Instruction Set" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Instruction Set </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> National Insititute of Technology, Calicut <br> <a href=https://creativecommons.org/licenses/by-nc/4.0/ rel=license> <img alt="Creative Commons License" style=border-width:0 src=https://licensebuttons.net/l/by-nc/4.0/80x15.png> </a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.com/exposnitc target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://groups.google.com/g/xos-users target=_blank rel=noopener title=groups.google.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 488 512"><path d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.top", "navigation.sections"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.477d984a.min.js", "version": null}</script> <script src=../../assets/javascripts/bundle.ddd52ceb.min.js></script> </body> </html>
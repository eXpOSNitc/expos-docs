<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="OS Lab website for NIT Calicut"><link href=https://exposnitc.github.io/expos-docs/roadmap/stage-28/ rel=canonical><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.2.1, mkdocs-material-7.1.10"><title>Stage 28 : Multi-Core Extension (12 Hours) - eXpOS NITC</title><link rel=stylesheet href=../../assets/stylesheets/main.1fe995fd.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.f1a3b89f.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/css/extra.css></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent> <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#installation class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-announce> <div class="md-announce__inner md-grid md-typeset"> <b>Site is undergoing migration.</b> Old URL: <a href=https://exposnitc.github.io/Roadmap.html target=_blank rel="nofollow noopener">https://exposnitc.github.io/Roadmap.html</a> </div> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="eXpOS NITC" class="md-header__button md-logo" aria-label="eXpOS NITC" data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> eXpOS NITC </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Stage 28 : Multi-Core Extension (12 Hours) </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=teal data-md-color-accent aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/eXpOSNitc/expos-docs/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> eXpOSNitc/expos-docs </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../documentation/ class=md-tabs__link> Documentation </a> </li> <li class=md-tabs__item> <a href=../ class="md-tabs__link md-tabs__link--active"> Roadmap </a> </li> <li class=md-tabs__item> <a href=../../faq/ class=md-tabs__link> FAQ </a> </li> <li class=md-tabs__item> <a href=../../feedback/ class=md-tabs__link> Student Feedback </a> </li> <li class=md-tabs__item> <a href=https://exposnitc.github.io/user-contrib/ target=_blank class=md-tabs__link> User Contributions </a> </li> <li class=md-tabs__item> <a href=../../about/ class=md-tabs__link> About </a> </li> <li class=md-tabs__item> <a href=http://xosnitc.github.io target=_blank class=md-tabs__link> XOS </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="eXpOS NITC" class="md-nav__button md-logo" aria-label="eXpOS NITC" data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> eXpOS NITC </label> <div class=md-nav__source> <a href=https://github.com/eXpOSNitc/expos-docs/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> eXpOSNitc/expos-docs </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Documentation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Documentation data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Documentation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../documentation/ class=md-nav__link> Documentation </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> Operating System <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Operating System" data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Operating System </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2_1 type=checkbox id=__nav_2_2_1> <label class=md-nav__link for=__nav_2_2_1> Specification <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Specification data-md-level=3> <label class=md-nav__title for=__nav_2_2_1> <span class="md-nav__icon md-icon"></span> Specification </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../os-spec/ class=md-nav__link> Specification </a> </li> <li class=md-nav__item> <a href=../../os-spec/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../os-spec/expos-abstractions/ class=md-nav__link> eXpOS Abstractions </a> </li> <li class=md-nav__item> <a href=../../os-spec/expfs/ class=md-nav__link> The Logical File System eXpFS </a> </li> <li class=md-nav__item> <a href=../../os-spec/processmodel/ class=md-nav__link> Process Model </a> </li> <li class=md-nav__item> <a href=../../os-spec/synchronization/ class=md-nav__link> Synchronization and Access Control </a> </li> <li class=md-nav__item> <a href=../../os-spec/misc/ class=md-nav__link> Micellaneous </a> </li> <li class=md-nav__item> <a href=../../os-spec/multiuser/ class=md-nav__link> Multi-User Extension to eXpOS </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2_1_9 type=checkbox id=__nav_2_2_1_9> <label class=md-nav__link for=__nav_2_2_1_9> Application Programmer's Interface (API) <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Application Programmer's Interface (API)" data-md-level=4> <label class=md-nav__title for=__nav_2_2_1_9> <span class="md-nav__icon md-icon"></span> Application Programmer's Interface (API) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../os-spec/systemcallinterface/ class=md-nav__link> High Level System Call Interface </a> </li> <li class=md-nav__item> <a href=../../os-spec/dynamicmemoryroutines/ class=md-nav__link> High Level Library Interface </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../os-spec/shell-spec/ class=md-nav__link> eXpOS Shell Specification </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2_2 type=checkbox id=__nav_2_2_2> <label class=md-nav__link for=__nav_2_2_2> Design <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Design data-md-level=3> <label class=md-nav__title for=__nav_2_2_2> <span class="md-nav__icon md-icon"></span> Design </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../os-design/ class=md-nav__link> Design </a> </li> <li class=md-nav__item> <a href=../../os-design/misc/ class=md-nav__link> Micellaneous </a> </li> <li class=md-nav__item> <a href=../../os-design/exe-handler/ class=md-nav__link> Exception Handler </a> </li> <li class=md-nav__item> <a href=../../os-design/timer/ class=md-nav__link> Timer </a> </li> <li class=md-nav__item> <a href=../../os-design/disk-interrupt/ class=md-nav__link> Disk Interrupt Handler </a> </li> <li class=md-nav__item> <a href=../../os-design/term-handler/ class=md-nav__link> Terminal Interrupt Handler </a> </li> <li class=md-nav__item> <a href=../../os-design/shutdown/ class=md-nav__link> Shutdown </a> </li> <li class=md-nav__item> <a href=../../os-design/create/ class=md-nav__link> Create </a> </li> <li class=md-nav__item> <a href=../../os-design/delete/ class=md-nav__link> Delete </a> </li> <li class=md-nav__item> <a href=../../os-design/open/ class=md-nav__link> Open </a> </li> <li class=md-nav__item> <a href=../../os-design/close/ class=md-nav__link> Close </a> </li> <li class=md-nav__item> <a href=../../os-design/read/ class=md-nav__link> Read </a> </li> <li class=md-nav__item> <a href=../../os-design/write/ class=md-nav__link> Write </a> </li> <li class=md-nav__item> <a href=../../os-design/seek/ class=md-nav__link> Seek </a> </li> <li class=md-nav__item> <a href=../../os-design/fork/ class=md-nav__link> Fork </a> </li> <li class=md-nav__item> <a href=../../os-design/exec/ class=md-nav__link> Exec </a> </li> <li class=md-nav__item> <a href=../../os-design/exit/ class=md-nav__link> Exit </a> </li> <li class=md-nav__item> <a href=../../os-design/proc-misc/ class=md-nav__link> Process Micellaneous </a> </li> <li class=md-nav__item> <a href=../../os-design/synchronization-algos/ class=md-nav__link> Synchronization Algorithms </a> </li> <li class=md-nav__item> <a href=../../os-design/semaphore-algos/ class=md-nav__link> Semaphore Algorithms </a> </li> <li class=md-nav__item> <a href=../../os-design/multiusersyscalls/ class=md-nav__link> Multi-User System Calls </a> </li> <li class=md-nav__item> <a href=../../os-design/disk-ds/ class=md-nav__link> Disk Data Structures </a> </li> <li class=md-nav__item> <a href=../../os-design/process-table/ class=md-nav__link> Process Table </a> </li> <li class=md-nav__item> <a href=../../os-design/mem-ds/ class=md-nav__link> Memory Data Structures </a> </li> <li class=md-nav__item> <a href=../../os-design/state-diag/ class=md-nav__link> Process State Diagram </a> </li> <li class=md-nav__item> <a href=../../os-design/nexpos/ class=md-nav__link> NeXpOS Design </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2_3 type=checkbox id=__nav_2_2_3> <label class=md-nav__link for=__nav_2_2_3> Implementation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Implementation data-md-level=3> <label class=md-nav__title for=__nav_2_2_3> <span class="md-nav__icon md-icon"></span> Implementation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../os-implementation/ class=md-nav__link> Implementation </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2_3_2 type=checkbox id=__nav_2_2_3_2> <label class=md-nav__link for=__nav_2_2_3_2> Kernel Stack Management <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Kernel Stack Management" data-md-level=4> <label class=md-nav__title for=__nav_2_2_3_2> <span class="md-nav__icon md-icon"></span> Kernel Stack Management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../os-design/stack-smcall/ class=md-nav__link> During System Calls </a> </li> <li class=md-nav__item> <a href=../../os-design/stack-interrupt/ class=md-nav__link> During Hardware interrupts or exceptions </a> </li> <li class=md-nav__item> <a href=../../os-design/stack-module/ class=md-nav__link> During Module calls </a> </li> <li class=md-nav__item> <a href=../../os-design/timer-stack-management/ class=md-nav__link> During Context Switch </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3> Architecture <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Architecture data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_1 type=checkbox id=__nav_2_3_1> <label class=md-nav__link for=__nav_2_3_1> Specification <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Specification data-md-level=3> <label class=md-nav__title for=__nav_2_3_1> <span class="md-nav__icon md-icon"></span> Specification </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../arch-spec/ class=md-nav__link> XSM Architecture Specifcation </a> </li> <li class=md-nav__item> <a href=../../virtual-machine-spec/ class=md-nav__link> Virtual Machine Model </a> </li> <li class=md-nav__item> <a href=../../arch-spec/machine-organization/ class=md-nav__link> Machine Organisation </a> </li> <li class=md-nav__item> <a href=../../arch-spec/interrupts-exception-handling/ class=md-nav__link> Interrupts and Exception Handling </a> </li> <li class=md-nav__item> <a href=../../arch-spec/instruction-set/ class=md-nav__link> Instruction Set </a> </li> <li class=md-nav__item> <a href=../../arch-spec/paging-hardware/ class=md-nav__link> Paging Hardware and Address Translation </a> </li> <li class=md-nav__item> <a href=../../arch-spec/nexsm/ class=md-nav__link> NEXSM (Two Core) Architecture Specification </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_2 type=checkbox id=__nav_2_3_2> <label class=md-nav__link for=__nav_2_3_2> Modules <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Modules data-md-level=3> <label class=md-nav__title for=__nav_2_3_2> <span class="md-nav__icon md-icon"></span> Modules </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modules/ class=md-nav__link> Modules </a> </li> <li class=md-nav__item> <a href=../../modules/module-00/ class=md-nav__link> Module 0 </a> </li> <li class=md-nav__item> <a href=../../modules/module-01/ class=md-nav__link> Module 1 </a> </li> <li class=md-nav__item> <a href=../../modules/module-02/ class=md-nav__link> Module 2 </a> </li> <li class=md-nav__item> <a href=../../modules/module-03/ class=md-nav__link> Module 3 </a> </li> <li class=md-nav__item> <a href=../../modules/module-04/ class=md-nav__link> Module 4 </a> </li> <li class=md-nav__item> <a href=../../modules/module-05/ class=md-nav__link> Module 5 </a> </li> <li class=md-nav__item> <a href=../../modules/module-06/ class=md-nav__link> Module 6 </a> </li> <li class=md-nav__item> <a href=../../modules/module-07/ class=md-nav__link> Module 7 </a> </li> <li class=md-nav__item> <a href=../../modules/module-08/ class=md-nav__link> Module 8 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3 type=checkbox id=__nav_2_3_3> <label class=md-nav__link for=__nav_2_3_3> Tutorials <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tutorials data-md-level=3> <label class=md-nav__title for=__nav_2_3_3> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tutorials/multiuser-implementation/ class=md-nav__link> MultiUser Implementation </a> </li> <li class=md-nav__item> <a href=../../tutorials/filesystem-implementation/ class=md-nav__link> FileSystem Implementation </a> </li> <li class=md-nav__item> <a href=../../tutorials/process-management-implementation/ class=md-nav__link> Process Management Implementation </a> </li> <li class=md-nav__item> <a href=../../tutorials/xsm-instruction-cycle/ class=md-nav__link> XSM Instruction Cycle </a> </li> <li class=md-nav__item> <a href=../../tutorials/xsm-interrupts-tutorial/ class=md-nav__link> XSM Interrupts tutorial </a> </li> <li class=md-nav__item> <a href=../../tutorials/xsm-unprivileged-tutorial/ class=md-nav__link> XSM Unprivileged tutorial </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_4 type=checkbox id=__nav_2_3_4> <label class=md-nav__link for=__nav_2_3_4> Support Tools <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Support Tools" data-md-level=3> <label class=md-nav__title for=__nav_2_3_4> <span class="md-nav__icon md-icon"></span> Support Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../support-tools/setting-up/ class=md-nav__link> Setting up </a> </li> <li class=md-nav__item> <a href=../../support-tools/docker-setup/ class=md-nav__link> Docker based setup </a> </li> <li class=md-nav__item> <a href=../../support-tools/xfs-interface/ class=md-nav__link> XFS Interface </a> </li> <li class=md-nav__item> <a href=../../support-tools/spl/ class=md-nav__link> SPL </a> </li> <li class=md-nav__item> <a href=../../support-tools/expl/ class=md-nav__link> ExpL </a> </li> <li class=md-nav__item> <a href=../../support-tools/xsm-simulator/ class=md-nav__link> XSM Simulator </a> </li> <li class=md-nav__item> <a href=../../support-tools/constants/ class=md-nav__link> Constants </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_5 type=checkbox id=__nav_2_3_5> <label class=md-nav__link for=__nav_2_3_5> Application Interface <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Application Interface" data-md-level=3> <label class=md-nav__title for=__nav_2_3_5> <span class="md-nav__icon md-icon"></span> Application Interface </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../abi/ class=md-nav__link> Application Binary Interface (ABI) </a> </li> <li class=md-nav__item> <a href=../../os-design/sw-interface/ class=md-nav__link> Low Level System Call Interface </a> </li> <li class=md-nav__item> <a href=../../os-spec/dynamicmemoryroutines/ class=md-nav__link> High Level Library Interface </a> </li> <li class=md-nav__item> <a href=../../abi/ class=md-nav__link> Low Level Library Interface </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> Others <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Others data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Others </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_1 type=checkbox id=__nav_2_4_1> <label class=md-nav__link for=__nav_2_4_1> Test Programs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Test Programs" data-md-level=3> <label class=md-nav__title for=__nav_2_4_1> <span class="md-nav__icon md-icon"></span> Test Programs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../test-programs/ class=md-nav__link> Test Programs </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-01/ class=md-nav__link> Program 1 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-02/ class=md-nav__link> Program 2 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-03/ class=md-nav__link> Program 3 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-04/ class=md-nav__link> Program 4 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-05/ class=md-nav__link> Program 5 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-06/ class=md-nav__link> Program 6 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-07/ class=md-nav__link> Program 7 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-08/ class=md-nav__link> Program 8 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-09/ class=md-nav__link> Program 9 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-10/ class=md-nav__link> Program 10 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-11/ class=md-nav__link> Program 11 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-12/ class=md-nav__link> Program 12 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-13/ class=md-nav__link> Program 13 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-14/ class=md-nav__link> Program 14 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-15/ class=md-nav__link> Program 15 </a> </li> <li class=md-nav__item> <a href=../../test-programs/test-program-16/ class=md-nav__link> Program 16 </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> Roadmap <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Roadmap data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Roadmap </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> Roadmap </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> Preparatory Stages <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Preparatory Stages" data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Preparatory Stages </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../stage-01/ class=md-nav__link> Stage 1 </a> </li> <li class=md-nav__item> <a href=../stage-02/ class=md-nav__link> Stage 2 </a> </li> <li class=md-nav__item> <a href=../stage-03/ class=md-nav__link> Stage 3 </a> </li> <li class=md-nav__item> <a href=../stage-04/ class=md-nav__link> Stage 4 </a> </li> <li class=md-nav__item> <a href=../stage-05/ class=md-nav__link> Stage 5 </a> </li> <li class=md-nav__item> <a href=../stage-06/ class=md-nav__link> Stage 6 </a> </li> <li class=md-nav__item> <a href=../stage-07/ class=md-nav__link> Stage 7 </a> </li> <li class=md-nav__item> <a href=../stage-08/ class=md-nav__link> Stage 8 </a> </li> <li class=md-nav__item> <a href=../stage-09/ class=md-nav__link> Stage 9 </a> </li> <li class=md-nav__item> <a href=../stage-10/ class=md-nav__link> Stage 10 </a> </li> <li class=md-nav__item> <a href=../stage-11/ class=md-nav__link> Stage 11 </a> </li> <li class=md-nav__item> <a href=../stage-12/ class=md-nav__link> Stage 12 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3> Intermediate Stages <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Intermediate Stages" data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Intermediate Stages </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../stage-13/ class=md-nav__link> Stage 13 </a> </li> <li class=md-nav__item> <a href=../stage-14/ class=md-nav__link> Stage 14 </a> </li> <li class=md-nav__item> <a href=../stage-15/ class=md-nav__link> Stage 15 </a> </li> <li class=md-nav__item> <a href=../stage-16/ class=md-nav__link> Stage 16 </a> </li> <li class=md-nav__item> <a href=../stage-17/ class=md-nav__link> Stage 17 </a> </li> <li class=md-nav__item> <a href=../stage-18/ class=md-nav__link> Stage 18 </a> </li> <li class=md-nav__item> <a href=../stage-19/ class=md-nav__link> Stage 19 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4 checked> <label class=md-nav__link for=__nav_3_4> Final Stages <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Final Stages" data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Final Stages </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../stage-20/ class=md-nav__link> Stage 20 </a> </li> <li class=md-nav__item> <a href=../stage-21/ class=md-nav__link> Stage 21 </a> </li> <li class=md-nav__item> <a href=../stage-22/ class=md-nav__link> Stage 22 </a> </li> <li class=md-nav__item> <a href=../stage-23/ class=md-nav__link> Stage 23 </a> </li> <li class=md-nav__item> <a href=../stage-24/ class=md-nav__link> Stage 24 </a> </li> <li class=md-nav__item> <a href=../stage-25/ class=md-nav__link> Stage 25 </a> </li> <li class=md-nav__item> <a href=../stage-26/ class=md-nav__link> Stage 26 </a> </li> <li class=md-nav__item> <a href=../stage-27/ class=md-nav__link> Stage 27 </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Stage 28 <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Stage 28 </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#installation class=md-nav__link> Installation </a> </li> <li class=md-nav__item> <a href=#outline class=md-nav__link> Outline </a> </li> <li class=md-nav__item> <a href=#data-structure-updates class=md-nav__link> Data Structure Updates </a> </li> <li class=md-nav__item> <a href=#access-control-module class=md-nav__link> Access Control Module </a> </li> <li class=md-nav__item> <a href=#bootstrap-procedure class=md-nav__link> Bootstrap Procedure </a> </li> <li class=md-nav__item> <a href=#modifications-to-scheduler-module class=md-nav__link> Modifications to Scheduler Module </a> </li> <li class=md-nav__item> <a href=#modifications-to-exception-handler-and-system-calls class=md-nav__link> Modifications to Exception Handler and System Calls </a> </li> <li class=md-nav__item> <a href=#modifications-to-timer-interrupt-handler class=md-nav__link> Modifications to Timer Interrupt Handler </a> </li> <li class=md-nav__item> <a href=#modifications-to-process-manager-and-pager-modules class=md-nav__link> Modifications to Process Manager and Pager Modules </a> </li> <li class=md-nav__item> <a href=#modifications-to-logout-system-call class=md-nav__link> Modifications to Logout System Call </a> </li> <li class=md-nav__item> <a href=#modifications-to-shutdown-system-call class=md-nav__link> Modifications to Shutdown System Call </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../faq/ class=md-nav__link> FAQ </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> Student Feedback <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Student Feedback" data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Student Feedback </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../feedback/ class=md-nav__link> Student Feedback </a> </li> <li class=md-nav__item> <a href=../../feedback/nitc21/ class=md-nav__link> NIT-C 2021 </a> </li> <li class=md-nav__item> <a href=../../feedback/nitc20/ class=md-nav__link> NIT-C 2020 </a> </li> <li class=md-nav__item> <a href=../../feedback/nitc19/ class=md-nav__link> NIT-C 2019 </a> </li> <li class=md-nav__item> <a href=../../feedback/iitpkd18/ class=md-nav__link> IIT PKD 2018 </a> </li> <li class=md-nav__item> <a href=../../feedback/nitc18/ class=md-nav__link> NIT-C 2018 </a> </li> <li class=md-nav__item> <a href=../../feedback/analysis/ class=md-nav__link> Analysis of Student Feedback </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://exposnitc.github.io/user-contrib/ target=_blank class=md-nav__link> User Contributions </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7> About <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=About data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../about/ class=md-nav__link> About </a> </li> <li class=md-nav__item> <a href=../../changelog/ class=md-nav__link> Changelog </a> </li> <li class=md-nav__item> <a href=../../reports/ class=md-nav__link> Project Reports </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=http://xosnitc.github.io target=_blank class=md-nav__link> XOS </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#installation class=md-nav__link> Installation </a> </li> <li class=md-nav__item> <a href=#outline class=md-nav__link> Outline </a> </li> <li class=md-nav__item> <a href=#data-structure-updates class=md-nav__link> Data Structure Updates </a> </li> <li class=md-nav__item> <a href=#access-control-module class=md-nav__link> Access Control Module </a> </li> <li class=md-nav__item> <a href=#bootstrap-procedure class=md-nav__link> Bootstrap Procedure </a> </li> <li class=md-nav__item> <a href=#modifications-to-scheduler-module class=md-nav__link> Modifications to Scheduler Module </a> </li> <li class=md-nav__item> <a href=#modifications-to-exception-handler-and-system-calls class=md-nav__link> Modifications to Exception Handler and System Calls </a> </li> <li class=md-nav__item> <a href=#modifications-to-timer-interrupt-handler class=md-nav__link> Modifications to Timer Interrupt Handler </a> </li> <li class=md-nav__item> <a href=#modifications-to-process-manager-and-pager-modules class=md-nav__link> Modifications to Process Manager and Pager Modules </a> </li> <li class=md-nav__item> <a href=#modifications-to-logout-system-call class=md-nav__link> Modifications to Logout System Call </a> </li> <li class=md-nav__item> <a href=#modifications-to-shutdown-system-call class=md-nav__link> Modifications to Shutdown System Call </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <!-- Edit button --> <a href=https://github.com/eXpOSNitc/expos-docs/edit/main/docs/roadmap/stage-28.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <!--
    Hack: check whether the content contains a h1 headline. If it
    doesn't, the page title (or respectively site name) is used
    as the main headline.
    --> <h1>Stage 28 : Multi-Core Extension (12 Hours)</h1> <!-- Markdown content --> <div class="admonition note"> <p class=admonition-title>Learning Objectives</p> <ul> <li>Modifying eXpOS kernel to exploit parallelism in a two core machine.</li> <li>Understanding processor synchronization in multi-core systems.</li> </ul> </div> <div class="admonition abstract"> <p class=admonition-title>Pre-requisite Reading</p> <ul> <li>Read and understand <a href=../../arch-spec/nexsm/ >NEXSM</a> (two core extension of XSM) specification.</li> <li>Read and understand design documentation for <a href=../../os-design/nexpos/ >eXpOS on NEXSM</a></li> </ul> </div> <h3 id=installation>Installation<a class=headerlink href=#installation title="Permanent link">&para;</a></h3> <p>Since you will be working on a new machine architecture on this stage, upgraded versions of the XSM machine simulator, SPL compiler, ExpL compiler and xfs-interface has to be downloaded. Create a new folder and download the upgraded eXpOS package so that there are no conflicts with the old version. The OS kernel code and other programs will have to be copied into the new folder before you start working.</p> <p>Follow the installation instructions <a href=../../support-tools/setting-up/#setting-up-nexsm>here</a> to download the upgraded eXpOS package.</p> <h3 id=outline>Outline<a class=headerlink href=#outline title="Permanent link">&para;</a></h3> <p>In this stage, you will port eXpOS to a two core extension of XSM called NEXSM. The specification of the OS does not undergo any change from the point of view of the end user or the application programmer (that is, the API - high level library interface or ABI - low level system call interface are unchanged except for some insignificant updates). Thus, the upward (application) interface of the OS does not change.</p> <p>What changes is the downward (architecture) interface. NEXSM supports a few more memory pages, a few more disk blocks and more significantly, a second core processor. The question is - how to make the best use of the available parallelism with minimal changes to the eXpOS code?</p> <p>The bootstrap process happens on one of the cores (called the <strong>primary core</strong> in NEXSM specification). The bootstrap code completes the initial set up operations and then start the other core (called <strong>secondary core</strong> ) into parallel action. A read only register called CORE will have value 0 in the primary and 1 in the secondary. This allows the kernel code to determine the core on which it is executing.</p> <p><strong>It is absolutely necessary to have a careful reading of the <a href=../../arch-spec/nexsm/ >NEXSM architecture specification</a> before proceeding further.</strong></p> <p>Once the OS is up and running on the two-core machine after bootstrap, <strong>each core runs the same OS code and schedules processes parallelly</strong> . The fundamental issue to be addressed is to ensure that <em>parallel actions of OS on the two cores do not lead the OS into an inconsistent state</em> .</p> <p>Handling concurrency is a tricky issue. Here, we impose a few conservative design level restrictions to the level of parallelism permitted so that a simple and comprehensible design is possible. The resultant design is not an efficient one; but it is sufficient to demonstrate the underlying principles. The constraints imposed are the following:</p> <ol> <li><strong>A single process will never be scheduled simultaneously on both the cores.</strong> The scheduler will be designed so as to ensure this policy. <strong>Only one core will run scheduling code at a given time.</strong> This makes implementation of the first policy straight-forward.</li> <li><strong>Only one core will be executing critical kernel code at a time.</strong> By critical kernel code, we mean <em>'kernel code that updates the <a href=../../os-design/ >Disk data structures and System-Wide data structures</a> '</em> . We will ensure that critical kernel code gets executed quickly and thus <strong>a core will never have to wait for a long time for the other core to leave critical section</strong> . (Non-interfering routines of the OS kernel are allowed to run parallelly - for instance both cores can enter the timer interrupt routine parallely; one core may be running the scheduler while the other is executing a system call and so on.)</li> <li>A few other simplifying design decisions are:<ol> <li><strong>The Login process and Shell Process will be run only from the primary.</strong> (As a consequence, logout and shutdown will be initiated only from the primary). <strong>The pager module will also be run only from the primary.</strong></li> <li><strong>An additional IDLE process</strong> is created at boot time (called IDLE2 with PID=14). IDLE2 will be scheduled in the second core when no other process can be scheduled. (The primary will schedule IDLE when no other process can be scheduled as in the current design). IDLE2 will never be swapped out. The primary core will never schedule IDLE2 and the secondary core will never schedule IDLE.</li> <li>When either <strong>logout</strong> or <strong>paging</strong> is initiated from the primary, the scheduler running on the <strong>secondary core will schedule the IDLE2 process</strong> .</li> </ol> </li> </ol> <p>How can the kernel implement the policies (a) and (b)? The implementation mechanism is to maintain two <strong>access lock variables</strong> - called SCHED_LOCK and KERN_LOCK. The kernel maintains an <strong>access lock table</strong> (starting at location 29576 - see <a href=../../os-implementation/ >here</a> ) where these lock variables are stored. The use of these variables will be described in detail below.</p> <p>Upon entry into a system call (respectively, scheduler code), the kernel first checks whether the other core is executing a system call code (respectively, scheduler code). If that is the case, the kernel waits for the other core to finish the critical system call code (respectively, scheduler code) before proceeding.</p> <h3 id=data-structure-updates>Data Structure Updates<a class=headerlink href=#data-structure-updates title="Permanent link">&para;</a></h3> <p>The <a href=../../os-design/mem-ds/#system-status-table>system status table</a> will now contain two new entries.</p> <ol> <li><strong>CURRENT_PID2:</strong> Stores the PID of the process running on the secondary core.</li> <li><strong>LOGOUT_STATUS:</strong> This field is set to 1 if logout is initiated on the primary core; set to 0 otherwise. If LOGOUT_STATUS is on, only IDLE2 will be scheduled in the secondary core.</li> </ol> <p>A new data structure called <a href=../../os-design/mem-ds/#access-lock-table><strong>access lock table</strong></a> is introduced. The fields that are of interest in this data structure are the following:<br> a) KERN_LOCK      b) SCHED_LOCK</p> <ol> <li>When the kernel enters a system call/exception handler (in either core), it first checks whether KERN_LOCK=1 (If so, the value should have been set to 1 by the kernel code running on the other core). In that case, the kernel executes a <a href=https://en.wikipedia.org/wiki/Spinlock><strong>spin lock</strong></a> (details will follow) till the kernel code running on the other core sets the lock back to zero. When the lock becomes available, the system call/exception handler sets KERN_LOCK to 1 and proceed with the normal execution of the system call. This ensures, mutual exclusion (between the two cores) for the critical code of system calls/exception handler. Since paging code is critical, KERN_LOCK is set before invoking the <a href=../../modules/module-08/ >pager module</a> (from the <a href=../../os-design/timer/ >timer interrupt handler</a> ) and set back to zero upon return from the pager module.</li> <li>At any point of time, if the system call/exception handler has to block for some event, it sets KERN_LOCK=0 before invoking the scheduler so that if the other core is waiting for KERN_LOCK, it can acquire the lock and enter critical section. Upon getting scheduled again, the system call/exception handler must do a spin lock again and set KERN_LOCK to 1 before proceeding. This protocol ensures that <em>a core holds onto the kernel lock only for short durations of time</em> . This also ensures that the kernel running on one core never holds on to SCHEDULE_LOCK and KERN_LOCK simultaneously. Finally, KERN_LOCK is set to zero before return to user mode after completion of the system call handler/exception handler code.</li> <li> <p>Before starting scheduling actions, the scheduler code first checks whether SCHED_LOCK is set to 1 by the scheduler code running on the other core. If the lock is set, a <strong>spin lock</strong> is executed (details will follow) till the scheduler code running on the other core resets the lock back to zero. This ensures that when scheduling actions are ongoing in one core, the other core waits. Note that scheduler code is small and will execute quickly, and hence the wait will not be for long. SCHED_LOCK is set to 0 at the end of scheduling.</p> </li> <li> <p>The fundamental point that must be understood is that the <strong>test and set operations on KERN_LOCK and SCHED_LOCK need to be atomic</strong> , for otherwise while one core is testing the value of a lock, the other core can change it from 0 to 1 and both the cores will simultaneously enter critical section. Atomicity of test and set operations can be achieved in two ways:</p> <ol> <li><strong>Hardware solution:</strong> If the hardware provides instructions to perform atomic test and set operations on a variable then the facility can be used.</li> <li><strong>Software Solution:</strong> Even if no hardware support is available, there are clever software solutions that achieve synchronization. <a href=https://en.wikipedia.org/wiki/Peterson%27s_algorithm>Peterson’s algorithm</a> is one famous solution.</li> </ol> <p>In our case, the NEXSM machine provides a hardware solution in the <a href=../../arch-spec/nexsm/#additional-privileged-mode-instructions><strong>TSL instruction</strong></a> to support atomic test and set operations and we will use this mechanism to implement atomic operations on KERN_LOCK and SCHED_LOCK variables.</p> </li> </ol> <h3 id=access-control-module>Access Control Module<a class=headerlink href=#access-control-module title="Permanent link">&para;</a></h3> <p>You will add a new module that implements atomic test and set operations on KERN_LOCK and SCHED_LOCK. The module will be added as Module 8 ( <a href=../../os-implementation/ >memory pages 132-133</a> ). Access control module supports the following functions:</p> <ol> <li>AcquireKernLock()</li> <li>AcquireSchedLock()</li> <li>ReleaseLock(LockVarAddress)</li> </ol> <div class="admonition note"> <p class=admonition-title>Note</p> <p>The <a href=../../os-design/nexpos/ >eXpOS design documentation</a> supports a general purpose lock called GLOCK, reserved for future enhancements. The present implementation does not need it and we will not discuss it in the roadmap.</p> </div> <p>The AccessLock functions can be implemented using the NEXSM <a href=../../arch-spec/nexsm/#additional-privileged-mode-instructions>TSL instruction</a> to ensure that locking is atomic. SPL provides the <a href=../../support-tools/spl/#spl-specification-for-nexsm>tsl instruction</a> which is translated to the XSM TSL machine instruction. The general locking logic in SPL would be the following.</p> <div class=highlight><pre><span></span><code>Acquire****Lock() {
    ....
    ....
    while (tsl (LockVariableAddress) == 1)
       continue;
    endwhile;
}
</code></pre></div> <p>This would translate to the following XSM code (or equivalent):</p> <div class=highlight><pre><span></span><code>L1: TSL Ri, [LockVariableAddress]
MOV Rj, 1
EQ Ri, Rj
JNZ Ri, L1
</code></pre></div> <p>The code atomically reads the lock variable repeatedly until its value is zero. Once the value is founf to be zero, the value is set to one. This procedure is sometimes called a <a href=https://en.wikipedia.org/wiki/Spinlock>spin lock</a> . A spin-lock is advisable only when the CPU only make a few iterations before the resource could be accessed, as in the present case.</p> <p><strong>Important:</strong> LOGOUT_STATUS will be used by the <a href=../../modules/module-08/#acquire-kernel-lock>Acquire Kernel Lock function</a> of the Access Control Module in the following way. <strong>When the <em>Acquire Kernel Lock</em> function is called from the secondary core, if PAGING_STATUS or LOGOUT_STATUS is on, then the lock must not be acquired.</strong> Instead, the state of the current process must be set to READY and the scheduler must be invoked. This is because when paging module is running or if the system has initiated logout (from the primary), normal processing is stopped and only IDLE2 must be scheduled in the secondary. (The scheduler will be designed so that under these circumstances, only IDLE2 will be scheduled for execution).</p> <p>The access control module algorithms are given <a href=../../modules/module-08/ >here</a> .</p> <h3 id=bootstrap-procedure>Bootstrap Procedure<a class=headerlink href=#bootstrap-procedure title="Permanent link">&para;</a></h3> <p>When NEXSM boots up, only the primary core will execute. Upon execution of the START instruction from the primary (see <a href=../../arch-spec/nexsm/ >NEXSM specification</a> ), the secondary starts execution from physical address 65536 (page 128 - <a href=../../os-implementation/ >see Memory Organisation</a> ). Hence, the primary bootstrap routine (OS startup code) must load the secondary bootstrap loader into memory before issuing START instruction. The IDLE2 process needs to be set up in memory. The access lock table entries are also initialized during bootstrap. A couple of new entries will be added to the <a href=../../os-design/mem-ds/#system-status-table>system status table</a> as well.</p> <p>The required changes to the primary <a href=../../os-design/misc/#os-startup-code>OS Startup code</a> /boot module are summarized below:</p> <ol> <li>Transfer the secondary bootstrap loader code from disk to memory (from disk block 512 to memory page 128). The access control module also must be loaded from disk to memory (blocks 516-517 to pages 132-133) - see <a href=../../os-implementation/ >disk and memory organization</a> . (Note: The design allows 2 blocks of secondary bootstrap code, but you will only need one block for the present eXpOS version).</li> <li>Set up the page tables for IDLE2 (PID=14) in memory. Since one user stack and one kernel stack pages will have to be allocated for IDLE2 (the first two free pages, 83 and 84 may be allocated). The <a href=../../os-design/mem-ds/#memory-free-list><strong>memory free list</strong></a> has to be updated accordingly. Also, the <strong>free memory count</strong> in the <a href=../../os-design/mem-ds/#system-status-table>system status table</a> will need corresponding update. The <a href=../../os-design/process-table/ >process table entries</a> for IDLE2 will be set (similar to IDLE). In particular, the state has to be set to RUNNING (as it is going to be running very soon on the secondary core!).</li> <li>New entries in the <a href=../../os-design/process-table/ >system status table</a> must be initialized. a) CURRENT_PID2 must be set to the the PID of IDLE2 process (PID=14). b) LOGOUT_STATUS must be set to 0.</li> <li>The access control variables KERN_LOCK and SCHED_LOCK of the <a href=../../os-design/mem-ds/#access-lock-table>Access Lock Table</a> must be initialized to 0.</li> <li>Issue the START instruction to start the secondary core into execution.</li> </ol> <p>The <strong>secondary bootstrap code</strong> that begins parallel execution upon START must do the following:</p> <ol> <li>Set up the return address in user stack of the IDLE2 process; SP, PTBR and PTLR registers must be updated.</li> <li>Execute <em>ireturn</em> to run IDLE2.</li> </ol> <p>Thus, the primary and secondary bootstrap code will schedule IDLE (PID=0) and IDLE2 (PID=14) on the respective cores at the end of system startup.</p> <h3 id=modifications-to-scheduler-module>Modifications to Scheduler Module<a class=headerlink href=#modifications-to-scheduler-module title="Permanent link">&para;</a></h3> <p>The scheduler module requires the following modifications:</p> <ol> <li>At the beginning of execution, determine whether scheduler is running on the primary or the secondary (read the CORE register value).</li> <li>SCHED_LOCK must be acquired by calling AcquireSchedLock() function of the <a href=../../modules/module-08/ >access control module</a> .</li> <li>If the core is <strong>primary</strong> , there is no change to existing algorithm <strong>except</strong> that:<ol> <li>IDLE2 (PID=14) must not be scheduled. (IDLE2 is scheduled only in the secondary).</li> <li>The Process which is currently running on the secondary core must not be scheduled (This can be determined by reading CURRENT_PID2 field of the <a href=../../os-design/mem-ds/#system-status-table>system status table</a> ).</li> <li>If LOGOUT_STATUS=1 and the secondary core is not running IDLE2, then schedule IDLE (wait for the current running process to be scheduled out of the secondary core).</li> </ol> </li> <li>If the core is <strong>secondary</strong> , there is no change to existing algorithm <strong>except</strong> that:<ol> <li>If PAGING_STATUS or LOGOUT_STATUS is set (in the <a href=../../os-design/mem-ds/#system-status-table>system status table</a> ), then IDLE2 must be scheduled).</li> <li>IDLE (PID=0), LOGIN (PID=1), SHELL (PID=2) and SWAPPER_DAEMON (PID=15) should never be scheduled, as the <a href=../../os-design/nexpos/ >eXpOS design</a> stipulates that these processes will run only on the primary.</li> <li>Process which is currently running on the primary core must not be scheduled (read CURRENT_PID field of the <a href=../../os-design/mem-ds/#system-status-table>system status table</a> ).</li> <li>The PID of the process that is selected for scheduling in the secondary core must be set to CURRENT_PID2 field of the system status table.</li> </ol> </li> <li>SCHED_LOCK must be released by calling <em>ReleaseLock()</em> function of the <a href=../../modules/module-08/ >access control module</a> before return from the scheduler. (Note: If the new process to be scheduled is in CREATED state, the scheduler directly returns to user mode using the ireturn statement. Do not forget to release SCHED_LOCK in this case as well!).</li> </ol> <h3 id=modifications-to-exception-handler-and-system-calls>Modifications to Exception Handler and System Calls<a class=headerlink href=#modifications-to-exception-handler-and-system-calls title="Permanent link">&para;</a></h3> <ol> <li>Before starting any system call, KERN_LOCK must be acquired by invoking <em>AcquireKernLock()</em> function of the <a href=../../modules/module-08/ >access control module</a> .</li> <li>The value of <strong>Current PID</strong> will be different on the primary and the secondary cores - [SYSTEM_STATUS_TABLE + 1] in the primary core and [SYSTEM_STATUS_TABLE + 6] in the secondary core. ( <strong>Implementation trick:</strong> the formula [SYSTEM_STATUS_TABLE + 5*CORE + 1] works on both the cores!!).</li> <li><em>ReleaseLock()</em> function of the <a href=../../modules/module-08/ >access control module</a> must be used to release KERN_LOCK before, a) any call to the scheduler, b) return from the system call/exception handler to the user program. Note that, the scheduler can be invoked not only from system calls, but also from kernel modules. In all such cases, KERN_LOCK must be released before invoking the scheduler.</li> <li><em>AcquireKernLock()</em> of the <a href=../../modules/module-08/ >access control module</a> must be invoked at any point after return from the scheduler (inside system calls as well as kernel modules).</li> </ol> <div class="admonition note"> <p class=admonition-title>Important Note</p> <p>When a process has acquired KERN_LOCK, any other process trying to acquire KERN_LOCK on the other core will be in a spin lock, doing no userful processing. Hence, your implementation should ensure that <em>ReleaseLock()</em> is invoked at the earliest point when it is safe to allow parallel execution of critical code from the other core. Further note that under normal conditions (except in Logout, Shutdown, etc.), updates to <a href=../../os-design/process-table/ >process table</a> and <a href=../../os-design/process-table/#per-process-page-table>page table</a> entries of a process are private to the process and there is no harm in letting other processes to run parallelly when a system call needs to make updates only to these data structures.</p> </div> <h3 id=modifications-to-timer-interrupt-handler>Modifications to Timer Interrupt Handler<a class=headerlink href=#modifications-to-timer-interrupt-handler title="Permanent link">&para;</a></h3> <ol> <li>Do not invoke <a href=../../modules/module-06/ >pager module</a> from the secondary core.</li> <li>When running on the primary core, call <em>AcquireKernLock()</em> and <em>ReleaseLock(KERN_LOCK)</em> of the <a href=../../modules/module-08/ >access control module</a> before and after calling pager module.</li> </ol> <h3 id=modifications-to-process-manager-and-pager-modules>Modifications to Process Manager and Pager Modules<a class=headerlink href=#modifications-to-process-manager-and-pager-modules title="Permanent link">&para;</a></h3> <ol> <li><em>Kill All</em> function in <a href=../../modules/module-01/ >process manager module</a> must not call <em>Exit Process</em> function for IDLE2 (PID=14) as this process is never killed.</li> <li><a href=../../modules/module-06/ >Pager module</a> must not swap out IDLE2 (PID=14).</li> </ol> <h3 id=modifications-to-logout-system-call>Modifications to Logout System Call<a class=headerlink href=#modifications-to-logout-system-call title="Permanent link">&para;</a></h3> <ol> <li>In <a href=../../os-design/multiusersyscalls/#logout>Logout System call</a> , first set LOGOUT_STATUS=1 in the <a href=../../os-design/mem-ds/#system-status-table>system status table</a> , but then call the scheduler (wait until secondary core schedules IDLE2 before proceeding).</li> <li>After execution of <em>Kill All</em> function, set LOGOUT_STATUS=0. In the <a href=../../os-design/mem-ds/#system-status-table>system status table</a> .</li> </ol> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Since, Logout is also a system call, all the updates done to system calls in general will apply to Logout as well.</p> </div> <h3 id=modifications-to-shutdown-system-call>Modifications to Shutdown System Call<a class=headerlink href=#modifications-to-shutdown-system-call title="Permanent link">&para;</a></h3> <p>In <a href=../../os-design/shutdown/ >Shutdown system call</a> , before calling <em>Kill All</em> function of the <a href=../../modules/module-01/ >process manager module</a> , reset the secondary core (using RESET instruction of NEXSM) and set SCHED_LOCK to 0.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Since, Shutdown is also a system call, all the updates done to system calls in general will apply to Shutdown as well.</p> </div> <p>We have tried to include all the necessary details. We leave it to you to figure out anything that is missing here and get the OS working!!</p> <details class=question><summary>Q1.Suppose the scheduler is about to resume execution of a process which was blocked while executing some system call, what would go wrong if we modify the present design so that <strong>scheduler simply sets</strong> <code>KERN_LOCK=1</code> before scheduling it (instead of the process doing a <code>AcquireKernLock()</code> inside the system call after being scheduled)? Note that the scheduler will not run simultaneously on both the cores.</summary><p>If the scheduler simply sets KERN_LOCK=1, then there is a possibility that the other core may have already acquired the KERN_LOCK. This causes both the cores to execute the critical section code parallelly, which will corrupt the OS data structures. Also, <code>AcquireKernLock()</code> function must be called from the system call, instead of the scheduler, as the return from scheduler may be to the timer interrupt handler which doesn't require a Kernel Lock.</p> </details> <details class=question><summary>Q2. Why should the logout system call wait for the secondary to execute IDLE2 before proceeding?</summary><p>The Logout system call terminates all the processes from 4 through 13 by calling the <code>Kill All</code> function in the process manager module. So, if this system call terminates the currently running process in the secondary core, the memory pages assigned to the process will be released by freeing the page table and user area page, which causes the secondary core to raise an exception. Waiting for the secondary core to schedule IDLE2 prevents this from happening.</p> </details> <div class="admonition assignment"> <p class=admonition-title>Assignment 1</p> <p>Run all the test cases of the previous stage. </p> </div> <div class="admonition assignment"> <p class=admonition-title>Assignment 2</p> <p>Modify the access locking algorithm to use <a href=https://en.wikipedia.org/wiki/Peterson%27s_algorithm>Peterson’s algorithm</a> instead of using the TSL instruction and run all test cases. </p> </div> <div class="admonition danger"> <p class=admonition-title>Thought Experiment</p> <p>Right now, all kernel code (except scheduler) operates with a single KERN_LOCK. Instead, suppose you put different lock variables for each kernel data structure, clearly, better use of parallelism can be achieved. What are the issues you have to consider when such a re-design is one? (You don’t have to do the experiment, but try to work out the design details on pen and paper). Do you think this will make the kernel run considerably faster? Can such a design lead to deadlocks?</p> </div> <!-- Last update of source file --> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../stage-27/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Stage 27" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Stage 27 </div> </div> </a> <a href=../../faq/ class="md-footer__link md-footer__link--next" aria-label="Next: FAQ" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> FAQ </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> National Insititute of Technology, Calicut <br> <a href=https://creativecommons.org/licenses/by-nc/4.0/ rel=license> <img alt="Creative Commons License" style=border-width:0 src=https://licensebuttons.net/l/by-nc/4.0/80x15.png> </a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.com/exposnitc target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://groups.google.com/g/xos-users target=_blank rel=noopener title=groups.google.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 488 512"><path d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.top", "navigation.sections"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.477d984a.min.js", "version": null}</script> <script src=../../assets/javascripts/bundle.ddd52ceb.min.js></script> </body> </html>